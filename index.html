<!DOCTYPE html>
<html lang = "en">

<head>
	<meta charset = "utf-8">
	<title>Tic Tac Toe</title>
	<style >
		body {
			font: 2em "courier";
		}

		input {
			color: #000;
		}
	</style>
</head>

<body>

<div id="board"></div>

<script>
	// DOCUMENT ELEMENTS
	// build a single square
	let constructSquare = ()=> {
		let sq = document.createElement( 'div' )
		sq.setAttribute( 'class', 'square' )

		return sq
	}

	// build the board
	let constructBoard = ()=> {
		var board = document.getElementById( "board" )
		var table = document.createElement( 'TABLE' )
		var tbody = document.createElement( 'TBODY' )

		table.appendChild( tbody )

		for( let row = 0; row < 3; row++ ){
			let tr = document.createElement( 'TR' )
			tbody.appendChild( tr )

			for( let col = 0; col < 3; col++ ){
				let td = document.createElement( 'TD' )
				tr.appendChild( td )
				td.appendChild( constructSquare() )
			}
		}

		board.appendChild( table )
	}

	constructBoard()

	// GENERATE BOARDS
	let ttt = new Array( 9 ).fill( '.' )
	let token = 'x'

	// animate
	var squares = document.querySelectorAll( '.square' )

	var render = ( board )=> {
		for( let [ i, square ] of squares.entries() ){
			square.innerHTML = board[ i ]
		}
	}

	let genMoves = ( board, token, ml )=> {
		for( let [ i, square ] of board.entries() ){
			if( square === '.' ){
				let nextBoard = board.slice()
				nextBoard[ i ] = token

				let nextToken
				token === 'x' ? nextToken = 'o' : nextToken = 'x'

				genMoves( nextBoard, nextToken, ml )
				ml.push( nextBoard )
			}
		}
	}

	let sleep = ( ms )=> {
		return new Promise( resolve => setTimeout( resolve, ms ))
	}

	async function walk( ml ){
		let numBoards = ml.length

		for( let i = 0; i < numBoards; i++ ){
			await sleep( 50 )
			render( ml[ i ])
		}
	}

	// Execute
	let ml = []
	genMoves( ttt, 'x', ml )
	walk( ml )

</script>
</body>




